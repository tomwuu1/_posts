---
title: Spring作业课
date: 2024-08-01 20:48:23
tags:
---



事务

save 和update

异常往外抛合不合理。

小黄鸭调试法

# 接口隔离

读写分离，扩展方向不一样，扩展上潜在的耦合。调用方，读和写都有要求才能调用，被动感知，按需设计sps，不同的使用方提供不同等级/容量的服务，设计接口的时候，对于容量的需求。有哪些请求方，让它们看到应该看到。

读和写可能相互影响

读和读都可能要隔离，快照和当前读。

接口设计

自定义异常：快速定位问题，要有多个异常，进行区分典型的业务场景和典型操作。



api response：error message（具体的错误信息），对于使用方的考虑。vo，偶发的异常oom允许重试，重大的错误没法重试直接返回。

切面的问题：无感知，方便，但不一定是正向影响。出现问题没法定位。什么时候完全无感知是好的：组件层面

加try-catch：如果切面逻辑有问题，避免影响业务代码。

计时：正常完成时间，异常完成时间，要根据业务流程的退出状态分别记录耗时。只计算正常完成的时间，异常退出要另做处理。获取System时间戳，有性能瓶颈（如何优雅的获取时间戳），缓存以毫秒作为记录。



打印异常：信息冗余。？？？

分层结构：下一层不应该感知到上一层的存在。

圈复杂度：用于衡量一个程序的复杂程度的度量方法

不建议超过两层缩进

jsr303校验，通过BindingResult获取校验结果



建表：create_time，update_time

老数据库显式的关闭事务提交，

嵌套事务（代码实践）

事务范围：定义db Service再在db service上进行事务管理



单测：盖亚

vo/dto/do/entity：

vo：入参（也和页面相关）和出参



rpm/rmi

dubbo：group业务集群做区分。

provider和consumer都要调api

rpc 传的对象要实现序列化。设置序列化ID，如果不设置没法进行兼容（默认-1），idea自动设置序列化ID 

api：里面不会引入lombok，api尽量不要引入其他包。api自定义的类里面，定义无参构造函数，避免有人加入了一个有参构造函数。

序列化工具依赖无参构造方法

dubbo provider异常不应该抛到外面去，包装返回类error message。如果能处理，可以抛出异常（比如参数有问题），放到方法签名里，dubbo的filter。



